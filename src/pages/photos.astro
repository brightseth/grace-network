---
import Layout from '../layouts/Layout.astro';
---

<Layout title="Photos | Seth Goldstein">
  <main class="photos-page">
    <header class="photos-header">
      <a href="/" class="back-link">SG</a>
      <div class="header-content">
        <h1>FAVORITES</h1>
        <p class="subtitle" id="subtitle">1,292 moments from 2024-2025</p>
      </div>
      <div class="controls">
        <button id="curate-btn" title="Toggle curator mode" style="display: none;">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
          </svg>
        </button>
        <button id="shuffle-btn" title="Shuffle photos">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="16 3 21 3 21 8"></polyline>
            <line x1="4" y1="20" x2="21" y2="3"></line>
            <polyline points="21 16 21 21 16 21"></polyline>
            <line x1="15" y1="15" x2="21" y2="21"></line>
            <line x1="4" y1="4" x2="9" y2="9"></line>
          </svg>
        </button>
        <button id="grid-toggle" title="Toggle grid size">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <rect x="3" y="3" width="7" height="7"></rect>
            <rect x="14" y="3" width="7" height="7"></rect>
            <rect x="14" y="14" width="7" height="7"></rect>
            <rect x="3" y="14" width="7" height="7"></rect>
          </svg>
        </button>
      </div>
    </header>

    <!-- Curator Panel -->
    <div class="curator-panel" id="curator-panel">
      <div class="curator-header">
        <h3>CURATOR MODE</h3>
        <span id="hidden-count">0 hidden</span>
      </div>
      <p class="curator-hint">Click X on photos to hide them. Copy the list below to update photos-curation.json</p>
      <textarea id="hidden-list" readonly placeholder="Hidden filenames will appear here..."></textarea>
      <div class="curator-actions">
        <button id="copy-hidden">Copy List</button>
        <button id="clear-hidden">Clear All</button>
        <button id="show-hidden">Show Hidden</button>
      </div>
    </div>

    <div class="loading-state" id="loading">
      <div class="loader"></div>
      <p>Loading your favorites...</p>
    </div>

    <div class="gallery" id="gallery"></div>

    <div class="photo-count-container" id="photo-count-container">
      <p class="photo-count" id="photo-count"></p>
    </div>

    <!-- Lightbox -->
    <div class="lightbox" id="lightbox">
      <button class="lightbox-close" id="lightbox-close">
        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <line x1="18" y1="6" x2="6" y2="18"></line>
          <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
      </button>
      <button class="lightbox-nav lightbox-prev" id="lightbox-prev">
        <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <polyline points="15 18 9 12 15 6"></polyline>
        </svg>
      </button>
      <button class="lightbox-nav lightbox-next" id="lightbox-next">
        <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <polyline points="9 18 15 12 9 6"></polyline>
        </svg>
      </button>
      <div class="lightbox-content">
        <img id="lightbox-img" src="" alt="Photo" />
      </div>
      <div class="lightbox-info" id="lightbox-info"></div>
      <div class="lightbox-counter" id="lightbox-counter"></div>
      <button class="lightbox-hide" id="lightbox-hide" style="display: none;">
        HIDE THIS PHOTO
      </button>
    </div>
  </main>
</Layout>

<script>
  interface Photo {
    filename: string;
    public_id: string;
    url: string;
    width: number;
    height: number;
    format: string;
    bytes: number;
    uploaded_at: string;
  }

  interface Manifest {
    uploaded_at: string;
    total: number;
    images: Photo[];
  }

  interface Curation {
    hidden: string[];
    featured: string[];
    lastUpdated: string;
    notes: string;
  }

  // State
  let allPhotos: Photo[] = [];
  let displayedPhotos: Photo[] = [];
  let hiddenFilenames: Set<string> = new Set();
  let sessionHidden: Set<string> = new Set(); // Photos hidden this session
  let batchSize = 100; // 10x10 grid
  let gridSize = 'small'; // Default to small for 10x10 grid
  let lightboxIndex = 0;
  let curatorMode = false;
  let showingHidden = false;

  // Check URL for curator mode
  const urlParams = new URLSearchParams(window.location.search);
  curatorMode = urlParams.get('curate') === 'true';

  // DOM elements
  const gallery = document.getElementById('gallery')!;
  const loading = document.getElementById('loading')!;
  const photoCount = document.getElementById('photo-count')!;
  const subtitle = document.getElementById('subtitle')!;
  const shuffleBtn = document.getElementById('shuffle-btn')!;
  const gridToggle = document.getElementById('grid-toggle')!;
  const curateBtn = document.getElementById('curate-btn')!;
  const curatorPanel = document.getElementById('curator-panel')!;
  const hiddenList = document.getElementById('hidden-list') as HTMLTextAreaElement;
  const hiddenCountEl = document.getElementById('hidden-count')!;
  const copyHiddenBtn = document.getElementById('copy-hidden')!;
  const clearHiddenBtn = document.getElementById('clear-hidden')!;
  const showHiddenBtn = document.getElementById('show-hidden')!;
  const lightbox = document.getElementById('lightbox')!;
  const lightboxImg = document.getElementById('lightbox-img') as HTMLImageElement;
  const lightboxClose = document.getElementById('lightbox-close')!;
  const lightboxPrev = document.getElementById('lightbox-prev')!;
  const lightboxNext = document.getElementById('lightbox-next')!;
  const lightboxCounter = document.getElementById('lightbox-counter')!;
  const lightboxInfo = document.getElementById('lightbox-info')!;
  const lightboxHide = document.getElementById('lightbox-hide')!;

  // Cloudinary transformations
  function getThumbUrl(photo: Photo): string {
    return photo.url.replace('/upload/', '/upload/c_fill,w_400,q_auto,f_auto/');
  }

  function getFullUrl(photo: Photo): string {
    return photo.url.replace('/upload/', '/upload/q_auto,f_auto/');
  }

  // Fisher-Yates shuffle
  function shuffle<T>(array: T[]): T[] {
    const arr = [...array];
    for (let i = arr.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [arr[i], arr[j]] = [arr[j], arr[i]];
    }
    return arr;
  }

  // Hide photo
  function hidePhoto(filename: string) {
    sessionHidden.add(filename);
    updateHiddenList();

    // Remove from gallery
    const items = gallery.querySelectorAll('.photo-item');
    items.forEach(item => {
      if (item.getAttribute('data-filename') === filename) {
        item.classList.add('hiding');
        setTimeout(() => item.remove(), 300);
      }
    });

    // Update displayed photos
    displayedPhotos = displayedPhotos.filter(p => p.filename !== filename);
    updatePhotoCount();
  }

  // Unhide photo
  function unhidePhoto(filename: string) {
    sessionHidden.delete(filename);
    updateHiddenList();
  }

  // Update hidden list textarea
  function updateHiddenList() {
    const allHidden = [...sessionHidden];
    hiddenList.value = JSON.stringify(allHidden, null, 2);
    hiddenCountEl.textContent = `${allHidden.length} hidden`;
  }

  // Create photo element
  function createPhotoElement(photo: Photo, index: number): HTMLElement {
    const div = document.createElement('div');
    div.className = 'photo-item';
    div.setAttribute('data-filename', photo.filename);

    const ratio = photo.width / photo.height;
    if (ratio > 1.3) {
      div.classList.add('landscape');
    } else if (ratio < 0.77) {
      div.classList.add('portrait');
    } else {
      div.classList.add('square');
    }

    const img = document.createElement('img');
    img.src = getThumbUrl(photo);
    img.alt = `Photo ${index + 1}`;
    img.loading = 'lazy';
    img.onclick = () => openLightbox(index);

    div.appendChild(img);

    // Add hide button in curator mode
    if (curatorMode) {
      const hideBtn = document.createElement('button');
      hideBtn.className = 'photo-hide-btn';
      hideBtn.innerHTML = '&times;';
      hideBtn.title = 'Hide this photo';
      hideBtn.onclick = (e) => {
        e.stopPropagation();
        hidePhoto(photo.filename);
      };
      div.appendChild(hideBtn);
    }

    return div;
  }

  // Display exactly 100 photos (10x10 grid)
  function displayPhotos() {
    gallery.innerHTML = '';

    // Filter out hidden photos and take first 100
    const visiblePhotos = allPhotos.filter(p =>
      showingHidden || (!hiddenFilenames.has(p.filename) && !sessionHidden.has(p.filename))
    );

    displayedPhotos = visiblePhotos.slice(0, 100);

    displayedPhotos.forEach((photo, i) => {
      const el = createPhotoElement(photo, i);
      gallery.appendChild(el);
      setTimeout(() => el.classList.add('visible'), i * 10);
    });

    updatePhotoCount();
  }

  function updatePhotoCount() {
    const totalVisible = allPhotos.filter(p =>
      showingHidden || (!hiddenFilenames.has(p.filename) && !sessionHidden.has(p.filename))
    ).length;
    photoCount.textContent = `Showing ${displayedPhotos.length} of ${totalVisible}`;
    subtitle.textContent = `${totalVisible} moments from 2024-2025`;
  }

  // Shuffle and display new random 100
  function shufflePhotos() {
    allPhotos = shuffle(allPhotos);
    displayPhotos();

    shuffleBtn.classList.add('spinning');
    setTimeout(() => shuffleBtn.classList.remove('spinning'), 500);
  }

  // Toggle grid size
  function toggleGrid() {
    const sizes = ['small', 'medium', 'large'];
    const currentIdx = sizes.indexOf(gridSize);
    gridSize = sizes[(currentIdx + 1) % sizes.length];
    gallery.className = `gallery grid-${gridSize}`;
    if (curatorMode) gallery.classList.add('curator-active');
  }

  // Lightbox functions
  function openLightbox(index: number) {
    lightboxIndex = index;
    const photo = displayedPhotos[index];
    lightboxImg.src = getFullUrl(photo);
    lightboxCounter.textContent = `${index + 1} / ${displayedPhotos.length}`;
    lightboxInfo.textContent = photo.filename;
    lightbox.classList.add('active');
    document.body.style.overflow = 'hidden';
  }

  function closeLightbox() {
    lightbox.classList.remove('active');
    document.body.style.overflow = '';
  }

  function prevPhoto() {
    lightboxIndex = (lightboxIndex - 1 + displayedPhotos.length) % displayedPhotos.length;
    const photo = displayedPhotos[lightboxIndex];
    lightboxImg.src = getFullUrl(photo);
    lightboxCounter.textContent = `${lightboxIndex + 1} / ${displayedPhotos.length}`;
    lightboxInfo.textContent = photo.filename;
  }

  function nextPhoto() {
    lightboxIndex = (lightboxIndex + 1) % displayedPhotos.length;
    const photo = displayedPhotos[lightboxIndex];
    lightboxImg.src = getFullUrl(photo);
    lightboxCounter.textContent = `${lightboxIndex + 1} / ${displayedPhotos.length}`;
    lightboxInfo.textContent = photo.filename;
  }

  // Event listeners
  shuffleBtn.addEventListener('click', shufflePhotos);
  gridToggle.addEventListener('click', toggleGrid);
  lightboxClose.addEventListener('click', closeLightbox);
  lightboxPrev.addEventListener('click', prevPhoto);
  lightboxNext.addEventListener('click', nextPhoto);
  lightbox.addEventListener('click', (e) => {
    if (e.target === lightbox) closeLightbox();
  });

  // Curator controls
  copyHiddenBtn.addEventListener('click', () => {
    navigator.clipboard.writeText(hiddenList.value);
    copyHiddenBtn.textContent = 'Copied!';
    setTimeout(() => copyHiddenBtn.textContent = 'Copy List', 2000);
  });

  clearHiddenBtn.addEventListener('click', () => {
    sessionHidden.clear();
    updateHiddenList();
    displayPhotos();
  });

  showHiddenBtn.addEventListener('click', () => {
    showingHidden = !showingHidden;
    showHiddenBtn.textContent = showingHidden ? 'Show Visible' : 'Show Hidden';
    displayPhotos();
  });

  lightboxHide.addEventListener('click', () => {
    const photo = displayedPhotos[lightboxIndex];
    hidePhoto(photo.filename);
    closeLightbox();
  });

  // Keyboard navigation
  document.addEventListener('keydown', (e) => {
    if (!lightbox.classList.contains('active')) return;

    if (e.key === 'Escape') closeLightbox();
    if (e.key === 'ArrowLeft') prevPhoto();
    if (e.key === 'ArrowRight') nextPhoto();
    if (e.key === 'h' && curatorMode) {
      const photo = displayedPhotos[lightboxIndex];
      hidePhoto(photo.filename);
      if (displayedPhotos.length > 0) {
        nextPhoto();
      } else {
        closeLightbox();
      }
    }
  });

  // Touch swipe
  let touchStartX = 0;
  lightbox.addEventListener('touchstart', (e) => {
    touchStartX = e.touches[0].clientX;
  });
  lightbox.addEventListener('touchend', (e) => {
    const touchEndX = e.changedTouches[0].clientX;
    const diff = touchStartX - touchEndX;
    if (Math.abs(diff) > 50) {
      if (diff > 0) nextPhoto();
      else prevPhoto();
    }
  });

  // Initialize
  async function init() {
    try {
      // Load manifest and curation config
      const [manifestRes, curationRes] = await Promise.all([
        fetch('/photos-manifest.json'),
        fetch('/photos-curation.json').catch(() => null)
      ]);

      const manifest: Manifest = await manifestRes.json();

      // Load hidden list from curation
      if (curationRes && curationRes.ok) {
        const curation: Curation = await curationRes.json();
        hiddenFilenames = new Set(curation.hidden || []);
      }

      // Enable curator mode UI
      if (curatorMode) {
        curateBtn.style.display = 'flex';
        curatorPanel.style.display = 'block';
        lightboxHide.style.display = 'block';
        document.body.classList.add('curator-mode');
      }

      // Shuffle on initial load
      allPhotos = shuffle(manifest.images);

      loading.style.display = 'none';
      gallery.className = `gallery grid-${gridSize}`;
      if (curatorMode) gallery.classList.add('curator-active');

      // Display exactly 100 photos
      displayPhotos();
    } catch (error) {
      console.error('Failed to load photos:', error);
      loading.innerHTML = '<p>Failed to load photos. Please refresh.</p>';
    }
  }

  init();
</script>

<style>
  .photos-page {
    min-height: 100vh;
    background: var(--color-bg, #000);
    color: var(--color-text-primary, #fff);
    font-family: var(--font-display, 'Helvetica Neue', Helvetica, Arial, sans-serif);
  }

  .photos-header {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    z-index: 100;
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1rem 2rem;
    background: rgba(0, 0, 0, 0.9);
    backdrop-filter: blur(10px);
    border-bottom: 1px solid #222;
  }

  .back-link {
    font-size: 1.5rem;
    font-weight: 900;
    color: #fff;
    text-decoration: none;
    letter-spacing: -0.02em;
  }

  .back-link:hover {
    color: #888;
  }

  .header-content {
    text-align: center;
  }

  h1 {
    font-size: 1.25rem;
    font-weight: 700;
    letter-spacing: 0.2em;
    margin: 0;
  }

  .subtitle {
    font-size: 0.75rem;
    color: #666;
    letter-spacing: 0.1em;
    margin: 0.25rem 0 0 0;
    text-transform: uppercase;
  }

  .controls {
    display: flex;
    gap: 0.5rem;
  }

  .controls button {
    background: transparent;
    border: 1px solid #333;
    color: #fff;
    padding: 0.5rem;
    cursor: pointer;
    transition: all 0.2s;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .controls button:hover {
    background: #fff;
    color: #000;
    border-color: #fff;
  }

  .controls button.spinning {
    animation: spin 0.5s ease;
  }

  .controls button.active {
    background: #ff4444;
    border-color: #ff4444;
  }

  @keyframes spin {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
  }

  /* Curator Panel */
  .curator-panel {
    display: none;
    position: fixed;
    top: 70px;
    right: 1rem;
    width: 300px;
    background: rgba(20, 20, 20, 0.95);
    border: 1px solid #333;
    border-radius: 8px;
    padding: 1rem;
    z-index: 99;
    backdrop-filter: blur(10px);
  }

  .curator-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 0.5rem;
  }

  .curator-header h3 {
    font-size: 0.75rem;
    font-weight: 700;
    letter-spacing: 0.1em;
    color: #ff4444;
    margin: 0;
  }

  #hidden-count {
    font-size: 0.75rem;
    color: #888;
  }

  .curator-hint {
    font-size: 0.625rem;
    color: #666;
    margin: 0 0 0.75rem 0;
    line-height: 1.4;
  }

  #hidden-list {
    width: 100%;
    height: 120px;
    background: #111;
    border: 1px solid #333;
    border-radius: 4px;
    color: #fff;
    font-family: monospace;
    font-size: 0.625rem;
    padding: 0.5rem;
    resize: none;
    margin-bottom: 0.75rem;
  }

  .curator-actions {
    display: flex;
    gap: 0.5rem;
  }

  .curator-actions button {
    flex: 1;
    padding: 0.5rem;
    font-size: 0.625rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    background: #222;
    border: 1px solid #444;
    color: #fff;
    cursor: pointer;
    transition: all 0.2s;
  }

  .curator-actions button:hover {
    background: #fff;
    color: #000;
  }

  .loading-state {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    min-height: 80vh;
    padding-top: 80px;
  }

  .loader {
    width: 40px;
    height: 40px;
    border: 2px solid #333;
    border-top-color: #fff;
    border-radius: 50%;
    animation: loader 0.8s linear infinite;
  }

  @keyframes loader {
    to { transform: rotate(360deg); }
  }

  .loading-state p {
    margin-top: 1rem;
    color: #666;
    font-size: 0.875rem;
    letter-spacing: 0.1em;
    text-transform: uppercase;
  }

  .gallery {
    padding: 80px 1rem 2rem 1rem;
    display: grid;
    gap: 4px;
  }

  .gallery.grid-small {
    grid-template-columns: repeat(10, 1fr);
  }

  .gallery.grid-medium {
    grid-template-columns: repeat(8, 1fr);
  }

  .gallery.grid-large {
    grid-template-columns: repeat(5, 1fr);
  }

  .photo-item {
    position: relative;
    overflow: hidden;
    background: #111;
    aspect-ratio: 1;
    cursor: pointer;
    opacity: 0;
    transform: scale(0.95);
    transition: opacity 0.3s, transform 0.3s;
  }

  .photo-item.visible {
    opacity: 1;
    transform: scale(1);
  }

  .photo-item.hiding {
    opacity: 0;
    transform: scale(0.8);
  }

  /* All photos are square in the 10x10 grid */
  .photo-item.landscape,
  .photo-item.portrait {
    grid-column: span 1;
    grid-row: span 1;
    aspect-ratio: 1;
  }

  .photo-item img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.5s ease;
  }

  .photo-item:hover img {
    transform: scale(1.05);
  }

  /* Hide button on photos */
  .photo-hide-btn {
    position: absolute;
    top: 0.5rem;
    right: 0.5rem;
    width: 28px;
    height: 28px;
    background: rgba(255, 0, 0, 0.8);
    border: none;
    border-radius: 50%;
    color: #fff;
    font-size: 1.25rem;
    font-weight: bold;
    cursor: pointer;
    opacity: 0;
    transition: opacity 0.2s, transform 0.2s;
    display: flex;
    align-items: center;
    justify-content: center;
    line-height: 1;
  }

  .photo-item:hover .photo-hide-btn {
    opacity: 1;
  }

  .photo-hide-btn:hover {
    transform: scale(1.1);
    background: rgba(255, 0, 0, 1);
  }

  .photo-count-container {
    padding: 1.5rem;
    text-align: center;
  }

  .photo-count {
    font-size: 0.75rem;
    color: #666;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    margin: 0;
  }

  /* Lightbox */
  .lightbox {
    position: fixed;
    inset: 0;
    z-index: 1000;
    background: rgba(0, 0, 0, 0.95);
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.3s;
  }

  .lightbox.active {
    opacity: 1;
    pointer-events: auto;
  }

  .lightbox-close {
    position: absolute;
    top: 1rem;
    right: 1rem;
    background: transparent;
    border: none;
    color: #fff;
    cursor: pointer;
    padding: 0.5rem;
    opacity: 0.7;
    transition: opacity 0.2s;
    z-index: 10;
  }

  .lightbox-close:hover {
    opacity: 1;
  }

  .lightbox-nav {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    background: transparent;
    border: none;
    color: #fff;
    cursor: pointer;
    padding: 1rem;
    opacity: 0.5;
    transition: opacity 0.2s;
    z-index: 10;
  }

  .lightbox-nav:hover {
    opacity: 1;
  }

  .lightbox-prev {
    left: 1rem;
  }

  .lightbox-next {
    right: 1rem;
  }

  .lightbox-content {
    max-width: 90vw;
    max-height: 90vh;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .lightbox-content img {
    max-width: 100%;
    max-height: 90vh;
    object-fit: contain;
  }

  .lightbox-counter {
    position: absolute;
    bottom: 1rem;
    left: 50%;
    transform: translateX(-50%);
    font-size: 0.875rem;
    color: #666;
    letter-spacing: 0.1em;
  }

  .lightbox-info {
    position: absolute;
    bottom: 2.5rem;
    left: 50%;
    transform: translateX(-50%);
    font-size: 0.625rem;
    color: #444;
    font-family: monospace;
    max-width: 80%;
    text-align: center;
    word-break: break-all;
  }

  .lightbox-hide {
    position: absolute;
    bottom: 1rem;
    right: 1rem;
    background: #ff4444;
    border: none;
    color: #fff;
    padding: 0.5rem 1rem;
    font-size: 0.625rem;
    font-weight: 700;
    letter-spacing: 0.1em;
    cursor: pointer;
    transition: all 0.2s;
  }

  .lightbox-hide:hover {
    background: #ff0000;
  }

  /* Mobile optimizations */
  @media (max-width: 768px) {
    .photos-header {
      padding: 0.75rem 1rem;
    }

    h1 {
      font-size: 1rem;
    }

    .subtitle {
      display: none;
    }

    .gallery {
      padding: 70px 0.5rem 1rem 0.5rem;
      gap: 2px;
    }

    .gallery.grid-small {
      grid-template-columns: repeat(5, 1fr);
    }

    .gallery.grid-medium {
      grid-template-columns: repeat(4, 1fr);
    }

    .gallery.grid-large {
      grid-template-columns: repeat(3, 1fr);
    }

    .lightbox-nav {
      padding: 0.5rem;
    }

    .lightbox-prev {
      left: 0.5rem;
    }

    .lightbox-next {
      right: 0.5rem;
    }

    .curator-panel {
      width: calc(100% - 2rem);
      right: 1rem;
      left: 1rem;
    }

    .photo-hide-btn {
      opacity: 0.8;
    }
  }
</style>
