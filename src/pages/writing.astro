---
import Layout from '../layouts/Layout.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import { getPosts, formatDate } from '../lib/ghost';

const posts = await getPosts(20);
---

<Layout
  title="Writing - Seth Goldstein"
  description="Essays, reflections, and occasional rants from Seth Goldstein. Topics include AI agents, autonomous culture, entrepreneurship, and the future of creativity."
  canonicalPath="/writing"
>
  <div class="min-h-screen bg-black text-white">
    <Header />

    <main class="max-w-3xl mx-auto px-6 py-16">
      <header class="mb-16">
        <h1 class="text-4xl md:text-5xl font-bold mb-4">Writing</h1>
        <p class="text-gray-400 text-lg">
          Essays, reflections, and occasional rants.
          <a href="https://seth.ghost.io" target="_blank" class="text-blue-400 hover:underline">RSS</a>
        </p>
      </header>

      {posts.length === 0 ? (
        <div class="text-gray-500 text-center py-16">
          <p>No posts yet. Check back soon.</p>
        </div>
      ) : (
        <div class="space-y-12">
          {posts.map((post) => (
            <article class="group border-b border-gray-800 pb-12 last:border-0">
              <a href={`https://seth.ghost.io/${post.slug}/`} target="_blank" class="block">
                {post.feature_image && (
                  <img
                    src={post.feature_image}
                    alt={post.title}
                    class="w-full h-48 object-cover mb-6 rounded opacity-90 group-hover:opacity-100 transition-opacity"
                  />
                )}
                <time class="text-sm text-gray-500 block mb-2">
                  {formatDate(post.published_at)}
                  {post.reading_time && ` · ${post.reading_time} min read`}
                </time>
                <h2 class="text-2xl md:text-3xl font-bold mb-3 group-hover:text-blue-400 transition-colors">
                  {post.title}
                </h2>
                {post.excerpt && (
                  <p class="text-gray-400 text-lg leading-relaxed">
                    {post.excerpt}
                  </p>
                )}
              </a>
              {post.tags && post.tags.length > 0 && (
                <div class="flex gap-2 mt-4">
                  {post.tags.map((tag) => (
                    <span class="text-xs text-gray-500 bg-gray-900 px-2 py-1 rounded">
                      {tag.name}
                    </span>
                  ))}
                </div>
              )}
            </article>
          ))}
        </div>
      )}

      <div class="mt-16 pt-8 border-t border-gray-800 text-center">
        <a
          href="https://seth.ghost.io"
          target="_blank"
          class="text-blue-400 hover:underline"
        >
          Read more at seth.ghost.io →
        </a>
      </div>
    </main>

    <Footer />
  </div>
</Layout>
